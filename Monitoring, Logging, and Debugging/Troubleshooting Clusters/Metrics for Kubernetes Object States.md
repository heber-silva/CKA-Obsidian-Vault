kube-state-metrics, an add-on agent to generate and expose cluster-level metrics.

The state of Kubernetes objects in the Kubernetes API can be exposed as metrics. An add-on agent calledÂ [kube-state-metrics](https://github.com/kubernetes/kube-state-metrics)Â can connect to the Kubernetes API server and expose a HTTP endpoint with metrics generated from the state of individual objects in the cluster. It exposes various information about the state of objects like labels and annotations, startup and termination times, status or the phase the object currently is in. For example, containers running in pods create aÂ `kube_pod_container_info`Â metric. This includes the name of the container, the name of the pod it is part of, theÂ [namespace](https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces)Â the pod is running in, the name of the container image, the ID of the image, the image name from the spec of the container, the ID of the running container and the ID of the pod as labels.

ðŸ›‡ This item links to a third party project or product that is not part of Kubernetes itself.Â [](https://kubernetes.io/docs/concepts/cluster-administration/kube-state-metrics/#third-party-content-disclaimer)

An external component that is able and capable to scrape the endpoint of kube-state-metrics (for example via Prometheus) can now be used to enable the following use cases.

## Example: using metrics from kube-state-metrics to query the cluster state[](https://kubernetes.io/docs/concepts/cluster-administration/kube-state-metrics/#example-kube-state-metrics-query-1)

Metric series generated by kube-state-metrics are helpful to gather further insights into the cluster, as they can be used for querying.

If you use Prometheus or another tool that uses the same query language, the following PromQL query returns the number of pods that are not ready:

```
count(kube_pod_status_ready{condition="false"}) by (namespace, pod)
```

## Example: alerting based on from kube-state-metrics[](https://kubernetes.io/docs/concepts/cluster-administration/kube-state-metrics/#example-kube-state-metrics-alert-1)

Metrics generated from kube-state-metrics also allow for alerting on issues in the cluster.

If you use Prometheus or a similar tool that uses the same alert rule language, the following alert will fire if there are pods that have been in aÂ `Terminating`Â state for more than 5 minutes:

```yaml
groups:
- name: Pod state
  rules:
  - alert: PodsBlockedInTerminatingState
    expr: count(kube_pod_deletion_timestamp) by (namespace, pod) * count(kube_pod_status_reason{reason="NodeLost"} == 0) by (namespace, pod) > 0
    for: 5m
    labels:
      severity: page
    annotations:
      summary: Pod {{$labels.namespace}}/{{$labels.pod}} blocked in Terminating state.
```

Items on this page refer to third party products or projects that provide functionality required by Kubernetes. The Kubernetes project authors aren't responsible for those third-party products or projects. See theÂ [CNCF website guidelines](https://github.com/cncf/foundation/blob/master/website-guidelines.md)Â for more details.

You should read theÂ [](https://kubernetes.io/docs/contribute/style/content-guide/#third-party-content)Â before proposing a change that adds an extra third-party link.